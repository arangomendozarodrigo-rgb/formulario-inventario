<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Inventario</title>
  <style>
    body{font-family:Arial;display:flex;justify-content:center;align-items:center;height:100vh;background:#f0f0f0;}
    .container{background:white;padding:30px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.2);width:350px;}
    input,select,button{width:100%;padding:10px;margin-top:6px;border-radius:6px;}
    .otros{display:none;}
  </style>
</head>
<body>
  <div class="container">
    <h2>Registro de Inventario</h2>
    <form id="form">
      <label>Nombre:</label>
      <input type="text" id="nombre" required>

      <label>Operación:</label>
      <select id="operacion" required>
        <option value="Ingreso">Ingreso</option>
        <option value="Salida">Salida</option>
      </select>

      <label>Herramienta:</label>
      <input list="herramientas" id="herramienta" required>
      <datalist id="herramientas"></datalist>

      <label id="labelCantidad">Cantidad:</label>
      <input type="number" id="cantidad" min="1" required>

      <div class="otros" id="otrosCampos">
        <label>Nombre nueva herramienta:</label>
        <input type="text" id="nuevoNombre">
        <label>Cantidad inicial:</label>
        <input type="number" id="cantidadInicial" min="1">
      </div>

      <button type="submit">Registrar</button>
    </form>
  </div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzZO4od17wCkBEsrvNYn4ZzCJP0n1PklxnCFSm8fi3d3SsbRfDs9m1rjiiGXnaQe-tCLw/exec"; // Pega aquí el enlace de tu Web App
const herramientaInput = document.getElementById("herramienta");
const otrosCampos = document.getElementById("otrosCampos");
const cantidadInput = document.getElementById("cantidad");
const labelCantidad = document.getElementById("labelCantidad");
const listaHerramientas = document.getElementById("herramientas");

// Cargar herramientas
fetch(WEB_APP_URL)
  .then(r=>r.json())
  .then(data=>{
    data.forEach(h=>{
      let option = document.createElement("option");
      option.value = h;
      listaHerramientas.appendChild(option);
    });
    let otros = document.createElement("option");
    otros.value = "Otros";
    listaHerramientas.appendChild(otros);
  });

// Mostrar campos "Otros"
herramientaInput.addEventListener("input", function(){
  if(this.value==="Otros"){
    otrosCampos.style.display="block";
    cantidadInput.style.display="none";
    labelCantidad.style.display="none";
    document.getElementById("cantidadInicial").required = true;
  } else {
    otrosCampos.style.display="none";
    cantidadInput.style.display="block";
    labelCantidad.style.display="block";
    document.getElementById("cantidadInicial").required = false;
  }
});

// Enviar formulario
document.getElementById("form").addEventListener("submit", function(e){
  e.preventDefault();
  let payload;
  if(herramientaInput.value==="Otros"){
    const nuevo = document.getElementById("nuevoNombre").value.trim();
    const cant = parseInt(document.getElementById("cantidadInicial").value);
    if(!nuevo || !cant){ alert("Ingresa nombre y cantidad"); return; }
    payload={nombre: document.getElementById("nombre").value, operacion:"Ingreso", herramienta:nuevo, cantidad:cant};
  } else {
    payload={nombre: document.getElementById("nombre").value, operacion:document.getElementById("operacion").value, herramienta:herramientaInput.value, cantidad:parseInt(cantidadInput.value)};
  }

  fetch(WEB_APP_URL,{
    method:"POST",
    body: JSON.stringify(payload),
    headers:{'Content-Type':'application/json'}
  }).then(r=>r.json()).then(()=>{alert("✅ Registro guardado"); this.reset(); otrosCampos.style.display="none"; cantidadInput.style.display="block"; labelCantidad.style.display="block";});
});
</script>
</body>
</html>



